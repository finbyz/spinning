[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Delivery Note", 
  "modified": "2019-07-10 18:39:03.121699", 
  "name": "Delivery Note-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "this.frm.add_fetch('batch_no', 'packaging_material', 'packaging_material');\nthis.frm.add_fetch('batch_no', 'packing_size', 'packing_size');\nthis.frm.add_fetch('batch_no', 'lot_no', 'lot_no');\n\n// Add searchfield to Item query\nthis.frm.cscript.onload = function(frm) {\n\tthis.frm.set_query(\"batch_no\", \"items\", function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\tif(!d.item_code){\n\t\t\tfrappe.throw(__(\"Please enter Item Code to get batch no\"));\n\t\t}\n\t\telse{\n\t\t\treturn {\n\t\t\t\tquery: \"spinning.batch_valuation.get_batch_no\",\n\t\t\t\tfilters: {\n\t\t\t\t\t'item_code': d.item_code,\n\t\t\t\t\t'warehouse': d.warehouse\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\nfrappe.ui.form.on(\"Delivery Note Item\", {\n\titem_code: function(frm, cdt, cdn){\n\t\tlet d = locals[cdt][cdn];\n\t\tsetTimeout(function(){\n\t\t\tfrappe.db.get_value(\"Batch\", d.batch_no, ['packaging_material', 'packing_size', 'lot_no'], function(r){\n\t\t\t\tfrappe.model.set_value(cdt, cdn, 'packaging_material', r.packaging_material);\n\t\t\t\tfrappe.model.set_value(cdt, cdn, 'packing_size', r.packing_size);\n\t\t\t\tfrappe.model.set_value(cdt, cdn, 'lot_no', r.lot_no);\n\t\t\t})\n\t\t}, 1000)\n\t},\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2019-07-10 18:41:44.213374", 
  "name": "Sales Invoice-Client", 
  "parent": null, 
  "parentfield": null, 
  "parenttype": null, 
  "script": "this.frm.add_fetch('batch_no', 'packaging_material', 'packaging_material');\nthis.frm.add_fetch('batch_no', 'packing_size', 'packing_size');\nthis.frm.add_fetch('batch_no', 'sample_ref_no', 'lot_no');\n\nthis.frm.set_query(\"batch_no\", \"items\", function(doc, cdt, cdn) {\n\t\tlet d = locals[cdt][cdn];\n\t\tif(!d.item_code){\n\t\t\tfrappe.throw(__(\"Please enter Item Code to get batch no\"));\n\t\t}\n\t\telse{\n\t\t\treturn {\n\t\t\t\tquery: \"spinning.batch_valuation.get_batch_no\",\n\t\t\t\tfilters: {\n\t\t\t\t\t'item_code': d.item_code,\n\t\t\t\t\t'warehouse': d.warehouse\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\nfrappe.ui.form.on(\"Sales Invoice Item\", {\n\titem_code: function(frm, cdt, cdn){\n\t\tlet d = locals[cdt][cdn];\n\t\tsetTimeout(function(){\n\t\t\tfrappe.db.get_value(\"Batch\", d.batch_no, ['packaging_material', 'packing_size', 'lot_no'], function(r){\n\t\t\t\tfrappe.model.set_value(cdt, cdn, 'packaging_material', r.packaging_material);\n\t\t\t\tfrappe.model.set_value(cdt, cdn, 'packing_size', r.packing_size);\n\t\t\t\tfrappe.model.set_value(cdt, cdn, 'lot_no', r.lot_no);\n\t\t\t})\n\t\t}, 1000)\n\t}\n});", 
  "script_type": "Client"
 }
]